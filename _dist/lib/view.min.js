/*! ****************************************************************************
 * View v0.0.3
 *
 * A companion View library for building web applications.
 * (you can download it from npm or github repositories)
 * Copyright (c) 2019 Mobilabs <contact@mobilabs.fr> (http://www.mobilabs.fr).
 * Released under the MIT license. You may obtain a copy of the License
 * at: http://www.opensource.org/licenses/mit-license.php).
 * ************************************************************************** */
!function(e,t){"use strict";"function"==typeof define&&define.amd?define([""],t):"object"==typeof exports?(module.exports=t(e),null===e.view&&(e.view=t(e))):e.View=t(e)}(this,e=>{"use strict";let t,n;const i={_:n,Messenger:null,Component:{Public:{},Generic:{},Dollar:{},Animation:{},Hyperscript:{},Render:{},Util:{}},Renderer:{Public:{}}};return n={extend(e,t){const n=Object.keys(t);for(let i=0;i<n.length;i++)e[n[i]]=t[n[i]];return e},assign(){const e=arguments[0];let t,n,i;for(i=1;i<arguments.length;i++)t=arguments[i],n=Object.keys(t).reduce((e,n)=>(e[n]=Object.getOwnPropertyDescriptor(t,n),e),{});return Object.defineProperties(e,n),e},isString:e=>"[object String]"===Object.prototype.toString.call(e),isNumber:e=>"[object Number]"===Object.prototype.toString.call(e),isObject(e){const t=typeof e;return("function"===t||"object"===t)&&!!e},isLiteralObject:e=>"[object Object]"===Object.prototype.toString.call(e),isFunction:e=>"[object Function]"===Object.prototype.toString.call(e),isArray:e=>"[object Array]"===Object.prototype.toString.call(e)},function(e,t){"function"==typeof define&&define.amd?define([""],t):"object"==typeof exports?(module.exports=t(e),null===e.Messenger&&(e.Messenger=t(e))):e.Messenger=t(e)}(i,e=>{let t,n;return function(){const i=e.Messenger;let r;t=function(){const e=Object.create(r);return e._db={},e},t.VERSION="0.0.1",t.noConflict=function(){return e.Messenger=i,this},r={subscribe(e,t){return n.subscribe(this._db,e,t),this},subscribeOnce(e,t){return n.subscribeOnce(this._db,e,t),this},unsubscribe(e,t){return n.unsubscribe(this._db,e,t),this},publish(e,t){return n.publish(this._db,e,t),this}}}(),function(){function e(e,t){"string"==typeof t&&function(e,t){Object.prototype.hasOwnProperty.call(e,t)||(e[t]={listeners:[],listenersOnce:[]})}(e,t)}n={subscribe(t,n,i){!function(t,n,i){e(t,n),"string"==typeof n&&"function"==typeof i&&Object.prototype.hasOwnProperty.call(t,n)&&t[n].listeners.push(i)}(t,n,i)},subscribeOnce(t,n,i){!function(t,n,i){e(t,n),"string"==typeof n&&"function"==typeof i&&Object.prototype.hasOwnProperty.call(t,n)&&t[n].listenersOnce.push(i)}(t,n,i)},unsubscribe(e,t,n){!function(e,t,n){let i;"string"==typeof t&&"function"==typeof n&&Object.prototype.hasOwnProperty.call(e,t)&&(i=e[t].listeners.indexOf(n),i>=0&&e[t].listeners.splice(i,1),i=e[t].listenersOnce.indexOf(n),i>=0&&e[t].listenersOnce.splice(i,1))}(e,t,n)},publish(e,t,n){!function(e,t,n){if("string"==typeof t&&Object.prototype.hasOwnProperty.call(e,t)){for(let i=0;i<e[t].listeners.length;i++)e[t].listeners[i](n);for(let i=0;i<e[t].listenersOnce.length;i++)e[t].listenersOnce[i](n);e[t].listenersOnce.splice(0,e[t].listenersOnce.length)}}(e,t,n)}}}(),t}),function(){const r=i.Renderer.Public,s=e.View;t={_setTestMode:()=>(i._=n,i),noConflict(){return e.View=s,this},render:e=>r.render(e),restore:e=>r.restore(e),append:e=>r.append(e),prepend:e=>r.prepend(e),remove:e=>r.remove(e)},t.VERSION="0.0.3"}(),function(){const{Generic:e}=i.Component,r=i.Component.Render;t.Component=function(t){let i;const r=function(){return this instanceof r?e.Construct.apply(this,i):(i=arguments,new r)},s=n.assign({},e.methods);return r.prototype=n.assign(s,t),r.prototype.constructor=r,r},t.Component._attachChild=function(e,t,n,i){r.attachChild(e,t,n,i)},t.Component._removeChild=function(e,t){r.removeChild(e,t)}}(),function(){const e=i.Component.Dollar,t=i.Component.Animation;n.extend(e,{$:function(e){const n=this.id;let i,r;return e?i=document.querySelector(`#${n}`).querySelector(e):(i=document.querySelector(`#${n}`),r=i),{0:i,id:i?i.id:null,_root:r,select:function(e){if("string"==typeof e&&this[0]){const t=this[0].querySelector(e);t&&(this[0]=t)}return this},selectChild:function(e){return"[object Number]"===Object.prototype.toString.call(e)&&(this[0]=this[0].children[e]?this[0].children[e]:this[0]),this},parent:function(){return this.root?this[0]!==this.root&&(this[0]=this[0].parentNode):this[0]=this[0].parentNode,this},firstParent:function(){return this._root&&(this[0]=this._root),this},html:function(e){return e?(this[0].innerHTML=e,this):this[0].innerHTML},empty:function(){for(;this[0].firstChild;)this[0].removeChild(this[0].firstChild);return this},append:function(e){const t=document.createElement(e);return this[0]=this[0].appendChild(t),this},appendTextChild:function(e){return this[0].appendChild(document.createTextNode(e)),this},appendBefore:function(e,t){const n=document.createElement(e),i=this[0].querySelector(t);return this[0].insertBefore(n,i),this[0]=n,this},appendAfter:function(e,t){const n=document.createElementNS(e),i=this[0].querySelector(t).nextElementSibling;return this[0].insertBefore(n,i),this[0]=n,this},replace:function(e){const t=document.createElement(e);return this[0].parentNode.replaceChild(t,this[0]),this[0]=t,this},appendHTML:function(e){return"string"==typeof e&&this[0].insertAdjacentHTML("beforeend",e),this},prepend:function(e){return"string"==typeof e&&this[0].insertAdjacentHTML("afterbegin",e),this},after:function(e){return"string"==typeof e&&this[0].id!==n&&this[0].insertAdjacentHTML("afterend",e),this},before:function(e){return"string"==typeof e&&this[0].id!==n&&this[0].insertAdjacentHTML("beforebegin",e),this},replaceWith:function(e){const t=this[0],i=t.parentNode,r=document.createElement("div");if("string"==typeof e&&t.id!==n){r.innerHTML=e;const n=r.firstChild;i.replaceChild(n,t)}return this},text:function(e){return void 0!==e?(this[0].textContent=e,this):this[0].textContent},clone:function(e){return!0===e||!1===e?this[0].cloneNode(e):this[0].cloneNode(!0)},firstChild:function(){return this[0].firstChild},insertChildBefore:function(e,t){return e&&this[0].insertBefore(e,t),this},removeChild:function(e){return e&&this[0].removeChild(e),this},replaceChild:function(e,t){return e&&this[0].replaceChild(e,t),this},children:function(){return this[0].children},childIndex:function(){let e=this[0],t=0;for(;null!==e;)e=e.previousElementSibling,t+=1;return t-1},getRect:function(){return this[0]?this[0].getBoundingClientRect():null},css:function(e,t){const n="string"==typeof e?e.split("-"):[];let i="";for(let e=0;e<n.length;e++)i+=0===e?n[e]:n[e].charAt(0).toUpperCase()+n[e].slice(1);return t?(this[0].style[i]=t,this):this[0].style[i]},getClassList:function(){return this[0].classList},addClass:function(e){return this[0].classList.add(e),this},addClasses:function(e){if(Array.isArray(e))for(let t=0;t<e.length;t++)this[0].classList.add(e[t]);return this},removeClass:function(e){return this[0].classList.remove(e),this},removeClasses:function(e){if(Array.isArray(e))for(let t=0;t<e.length;t++)this[0].classList.remove(e[t]);return this},toggleClass:function(e){return this[0].classList.toggle(e),this},hasClass:function(e){const t=this[0].classList.value.split(" ");return"[object String]"===Object.prototype.toString.call(e)&&-1!==t.indexOf(e)},attr:function(e,t){return t?(this[0].setAttribute(e,t),this):this[0].getAttribute(e)},removeAttr:function(e){return e&&this[0].removeAttribute(e),this},animate:function(...e){return t.animate(this[0],...e),this},on:function(e,t){return this[0].addEventListener(e,t),this},off:function(e,t){return this[0].removeEventListener(e,t),this},trigger:function(e){return this[0].dispatchEvent(new Event(e))}}}})}(),function(){const e=i.Component.Generic,{$:t}=i.Component.Dollar,r=i.Component.Render,{Util:s}=i.Component;const o={_init(e){return this._tag=null,this._cList=null,this._mess=null,this.id=`i${Math.random().toString(36).substr(2,7)}`,this.children=null,this.props={},this.props.options=n.isLiteralObject(arguments[0])?arguments[0]:{},this.props.options=e,this.name="mynameisnobody",this.init(),this},_renderer(){return r.render(this)},$:t,$hyperscript(e,t){const n=[];for(let e=2;e<arguments.length;e++)n.push(arguments[e]);return{nodeName:e,attributes:t,children:n}},$getIdAndName(){return{id:this.id,name:this.name}},$getChildren(){return s.getChildren(this)},$getChild(e){return s.getChild(this,e)},$show(){return this.$().css("display","block"),this},$hide(){return this.$().css("display","none"),this},$listen(e,t){return this._mess.subscribe(e,t),this},$emit(e,t){return this._mess.publish(e,t),this},init(){return this},events(){return this},render:()=>"<div></div>"};n.extend(e,{Construct:function(){this._init.apply(this,arguments)},methods:o})}(),function(){const e=i.Component.Animation;function t(e,t,n,i){return n*(.5-Math.cos(e/i*Math.PI)/2)+t}function r(e){const t=n.isString(e)?e.split("-"):[];let i="";for(let e=0;e<t.length;e++)i+=0===e?t[e]:t[e].charAt(0).toUpperCase()+t[e].slice(1);return i}function s(e,t,n,i,s,o){const c=function(e,t){const n=Object.keys(t),i=window.getComputedStyle(e),s={},o=[];let c,l,u,a;for(let d=0;d<n.length;d++)c=r(n[d]),l=i.getPropertyValue(c),l&&(o.push(c),l=parseFloat(l,10),a=t[n[d]].replace(/[0-9.]/g,""),"%"===a&&(u=parseFloat(window.getComputedStyle(e.parentNode).getPropertyValue(c)),l=l/u*100),s[c]={initial:l,change:parseFloat(t[n[d]])-l,suffix:a});return s.name=o,s}(e,t),l=e;let u,a=0;const d=setInterval(()=>{for(let e=0;e<c.name.length;e++)u=n(a,c[c.name[e]].initial,c[c.name[e]].change,i),l.style[c.name[e]]=u+c[c.name[e]].suffix;a+=s,a>i&&(clearInterval(d),o&&o())},s)}n.extend(e,{animate(e,i,...r){if(!n.isLiteralObject(i))return;const o=function(...e){const t=e[0],i=e[1],r=e[2];let s,o,c,l;switch(s=t||i||r?!t||i||i?t&&i&&!r?2:3:1:0,s){case 0:break;case 1:n.isNumber(t)||"fast"===t||"slow"===t?o=t:n.isString(t)?c=t:n.isFunction(t)&&(l=t);break;case 2:n.isNumber(t)||"fast"===t||"slow"===t?(o=t,n.isString(i)?c=i:n.isFunction(i)&&(l=i)):n.isString(t)&&(c=t,n.isFunction(i)&&(l=i));break;case 3:(n.isNumber(t)||"fast"===t||"slow"===t)&&(o=t),n.isString(i)&&(c=i),n.isFunction(r)&&(l=r)}return{duration:o,easing:c,callback:l}}(...r),c=n.isNumber(o.duration)&&o.duration>0?o.duration:"fast"===(l=o.duration)?200:"slow"===l?600:400;var l;s(e,i,window.Easing&&window.Easing[o.easing]?window.Easing[o.easing]:t,c,10,o.callback?o.callback:null)}})}(),function(){const e=i.Component.Hyperscript;function t(e){const t=Object.keys(e);let n="";for(let i=0;i<t.length;i++)n+=i<t.length-1?`${t[i]}: ${e[t[i]]}; `:`${t[i]}: ${e[t[i]]};`;return n}n.extend(e,{render(e,i){const r={};return function(e,t,n){const i=Object.keys(n);for(let r=0;r<i.length;r++)e=e.replace(`</${i[r].toLowerCase()}>`,"").replace(i[r].toLowerCase(),`${i[r]} /`),t[`<${i[r]} />`]=n[i[r]];return e}((new XMLSerializer).serializeToString(function e(i,r){const{nodeName:s}=i,{attributes:o}=i,{children:c}=i;let l,u,a,d,h,p;if(n.isString(i))return document.createTextNode(i);switch(typeof s){case"string":for(l=document.createElement(s),u=o?Object.keys(o):[],p=0;p<u.length;p++)a=n.isObject(o[u[p]])?t(o[u[p]]):o[u[p]],l.setAttribute(u[p],a);break;case"function":d=s(),d.render?(h=o&&o.name?o.name:`C${Math.random().toString(36).substr(2,7)}`,r[h]={fn:s,options:o.options?o.options:null},l=e({nodeName:h,attributes:null,children:[]},r)):l=e(d,r);break;default:throw new Error(`hypserscript._render: nodeName is a ${typeof s} ???`)}for(p=0;p<c.length;p++)l.appendChild(e(c[p],r));return l}(e,r)).replace('xmlns="http://www.w3.org/1999/xhtml"',""),i,r)}})}(),function(){const e=i.Component.Render,t=i.Component.Hyperscript;function r(e){let i,r;if(i=e.render(),n.isLiteralObject(i)&&n.isString(i.nodeName)&&(e.children={},i=t.render(i,e.children)),r=i.match(/^\s*<div/)?i.replace(/^\s*<div/,`<div id="${e.id}"`):i.match(/^\s*<header/)?i.replace(/^\s*<header/,`<header id="${e.id}"`):i.match(/^\s*<footer/)?i.replace(/^\s*<footer/,`<footer id="${e.id}"`):i,e.children){e.children=function(e){if(!n.isLiteralObject(e))return{};const t={},i=Object.keys(e);let r;for(let s=0;s<i.length;s++)r=i[s],n.isFunction(e[r])?t[r]={fn:e[r],options:null}:n.isLiteralObject(e[r])&&n.isFunction(e[r].fn)?t[r]={fn:e[r].fn,options:e[r].options}:(t[r]={fn:null,options:null},console.log('warning: this component list is invalid. key "c" is missing!'));return t}(e.children),e._cList={};const t=Object.keys(e.children);let i,s;for(let o=0;o<t.length;o++)i=t[o],n.isFunction(e.children[i].fn)?(s=e.children[i].fn(e.children[i].options),s._tag=i,r=r.replace(i,s._renderer()),e._cList[i.replace(/[^a-zA-z0-9]/g,"")]=s):console.log(`warning: there is no component associated to this tag: ${i}!`)}return r}n.extend(e,{render:e=>r(e),attachChild(e,t,n,i){!function(e,t,n,i){const r=t(n);r._tag=i,e._cList||(e._cList={}),e.children||(e.children={}),e._cList[r._tag.replace(/[^a-zA-z0-9]/g,"")]=r,e.children[i]={fn:t,options:n}}(e,t,n,i)},removeChild(e,t){!function(e,t){n.isString(t)&&n.isLiteralObject(e._cList)&&(delete e._cList[t.replace(/[^a-zA-z0-9]/g,"")],delete e.children[t])}(e,t)}})}(),function(){const e=i.Component.Util;n.extend(e,{getChildren:e=>e._cList?function(e){const t=Object.keys(e._cList),n=[];for(let i=0;i<t.length;i++)n.push({id:e._cList[t[i]].id,name:e._cList[t[i]].name});return n}(e):null,getChild:(e,t)=>t&&n.isString(t)?function e(t,n){if(!t._cList)return null;const i=Object.keys(t._cList);let r;for(let s=0;s<i.length;s++){if(r=i[s],n===t._cList[r]._tag||n===t._cList[r].id||n===t._cList[r].name)return t._cList[r];const o=e(t._cList[r],n);if(o)return o}return null}(e,t):null})}(),function(){const e=i.Renderer.Public,{Messenger:r}=i;function s(e){if(e._cList){const t=Object.keys(e._cList);for(let n=0;n<t.length;n++)e._cList[t[n]].events(),s(e._cList[t[n]])}}function o(e,t){if(e._cList){const n=Object.keys(e._cList);for(let i=0;i<n.length;i++)e._cList[n[i]]._mess=t,o(e._cList[n[i]],t)}}function c(e){const t={el:"body",children:null,template:"<div></div>"};return e.el&&(!n.isString(e.el)||"#"!==e.el.charAt(0)&&"."!==e.el.charAt(0)?n.isObject(e.el)&&e.el.namespaceURI?t.el=e.el:console.log("warning: el must be an id, a class or a node element!"):t.el=e.el),n.isString(e.template)&&(e.template.includes("<div")||e.template.includes("<header")||e.template.includes("<footer"))?t.template=e.template:console.log("warning: template must be an XMLString starting with <div or <header or <footer!"),t.children=e.children,t}function l(e){const t=n.isString(e.el)?document.querySelector(e.el):e.el;"body"===e.el?t.innerHTML+=e.template:t.innerHTML=e.template}function u(e){const i=c(e);if(!e.children&&!e.template)return function(e){const i=c(e);if("body"===i.el)return null;let s;s=n.isString(i.el)?document.querySelector(i.el):i.el;const o=s.outerHTML,l=s.getAttribute("id");l&&s.removeAttribute("id");const u=s.outerHTML;let a={};e.methods&&(a=e.methods);const d=t.Component(n.extend(a,{render:()=>u}))(),h=d._renderer(),p=document.createElement("template");p.innerHTML=h;const f=p.content.firstChild;return s.parentNode.replaceChild(f,s),l&&(f.setAttribute("id",l),d.id=l),d._mess=r(),d._initialXMLNode=o,d}(e);if(!i.children)return l(i),null;const u=t.Component({render(){return this.name="firstparent",this.children=i.children,i.template}})();return i.template=u._renderer(),l(i),u._mess=r(),o(u,u._mess),s(u),u}function a(e,t,i,r){const s=e.$getChild(t)._renderer();i?n.isString(i)&&e.$(i)[0]?"first"===r?e.$(i).prepend(s):e.$(i).appendHTML(s):(console.log("warning: View.append: params.el is not valid! Component appended to the parent node."),"first"===r?e.$().prepend(s):e.$().appendHTML(s)):"first"===r?e.$().prepend(s):e.$().appendHTML(s)}function d(e,i){const{root:r}=e,{children:c}=e,{el:l}=e;let u,d,h,p,f,m,{parent:g}=e;if(g||(g=r),n.isString(g)){if(!n.isObject(r)||!Object.prototype.hasOwnProperty.call(r,"_cList"))return console.log("warning: View.append: params.root is not valid!"),null;if(u=r.$getChild(g),!u)return console.log(`warning: View.append: ${g} does not exist!`),null}else{if(!n.isObject(g)||!Object.prototype.hasOwnProperty.call(g,"_cList"))return console.log(`warning: View.append: ${g} is improperly defined!`),null;u=g}if(!n.isLiteralObject(c))return console.log("warning: View.append: params.children is not valid!"),null;const b=Object.keys(c);for(let e=0;e<b.length;e++){if(m=b[e],d=c[b[e]],n.isLiteralObject(d))p=d.fn,f=d.options;else{if(!n.isFunction(d))return console.log("warning: View.append: params.children is not valid!"),null;p=d,f=void 0}t.Component._attachChild(u,p,f,m),a(u,m,l,i),h=u.$getChild(m),h._mess=u._mess,o(h,u._mess),h.events(),s(h)}return!0}n.extend(e,{render:e=>u(e),restore:e=>(function(e){if(e._initialXMLNode){const t=document.createElement("template");t.innerHTML=e._initialXMLNode;const n=t.content.firstChild;return e.$()[0].parentNode.replaceChild(n,e.$()[0]),!0}return!1})(e),append:e=>d(e),prepend:e=>d(e,"first"),remove:e=>(function(e){const{root:i}=e,{parent:r}=e,{children:s}=e;let o;if(n.isString(r)){if(!n.isObject(i)||!Object.prototype.hasOwnProperty.call(i,"_cList"))return console.log("warning: View.append: params.root is not valid!"),null;if(o=i.$getChild(r),!o)return console.log(`warning: View.append: ${r} does not exist!`),null}else{if(!n.isObject(r)||!Object.prototype.hasOwnProperty.call(r,"_cList"))return console.log(`warning: View.append: ${r} is improperly defined!`),null;o=r}if(!n.isString(s))return console.log("warning: View.append: params.children is not valid!"),null;const c=o.$getChild(s),l=o.$(`#${c.id}`)[0];return o.$(`#${c.id}`).parent().removeChild(l),t.Component._removeChild(o,s),!0})(e)})}(),t});