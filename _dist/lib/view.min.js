/*! ****************************************************************************
 * View v0.0.5
 *
 * A companion View library for building web applications.
 * (you can download it from npm or github repositories)
 * Copyright (c) 2020 Mobilabs <contact@mobilabs.fr> (http://www.mobilabs.fr).
 * Released under the MIT license. You may obtain a copy of the License
 * at: http://www.opensource.org/licenses/mit-license.php).
 * ************************************************************************** */
!function(e,t){"use strict";"function"==typeof define&&define.amd?define([""],t):"object"==typeof exports?(module.exports=t(e),null===e.View&&(e.View=t(e))):e.View=t(e)}(this,e=>{"use strict";let t,n={src:{view:{},libin:{Messenger:null},lib:{_:{}},component:{main:{},$:{},animate:{},generic:{},hyperscript:{},render:{},util:{}},renderer:{main:{}}},extend:function(e,t){for(var n=Object.keys(t),i=0;i<n.length;i++)e[n[i]]=t[n[i]]}};return function(){const i=n.src.renderer.main,r=e.View;t={_setTestMode:()=>n,noConflict(){return e.View=r,this},render:e=>i.render(e),restore:e=>i.restore(e),append:e=>i.append(e),prepend:e=>i.prepend(e),remove:e=>i.remove(e)},t.VERSION="0.0.5"}(),function(e,t){"function"==typeof define&&define.amd?define([""],t):"object"==typeof exports?(module.exports=t(e),null===e.Messenger&&(e.Messenger=t(e))):e.Messenger=t(e)}(n.src.libin,e=>{let t,n;return function(){const i=e.Messenger;let r;t=function(){const e=Object.create(r);return e._db={},e},t.VERSION="0.0.1",t.noConflict=function(){return e.Messenger=i,this},r={subscribe(e,t){return n.subscribe(this._db,e,t),this},subscribeOnce(e,t){return n.subscribeOnce(this._db,e,t),this},unsubscribe(e,t){return n.unsubscribe(this._db,e,t),this},publish(e,t){return n.publish(this._db,e,t),this}}}(),function(){function e(e,t){"string"==typeof t&&function(e,t){Object.prototype.hasOwnProperty.call(e,t)||(e[t]={listeners:[],listenersOnce:[]})}(e,t)}n={subscribe(t,n,i){!function(t,n,i){e(t,n),"string"==typeof n&&"function"==typeof i&&Object.prototype.hasOwnProperty.call(t,n)&&t[n].listeners.push(i)}(t,n,i)},subscribeOnce(t,n,i){!function(t,n,i){e(t,n),"string"==typeof n&&"function"==typeof i&&Object.prototype.hasOwnProperty.call(t,n)&&t[n].listenersOnce.push(i)}(t,n,i)},unsubscribe(e,t,n){!function(e,t,n){let i;"string"==typeof t&&"function"==typeof n&&Object.prototype.hasOwnProperty.call(e,t)&&(i=e[t].listeners.indexOf(n),i>=0&&e[t].listeners.splice(i,1),i=e[t].listenersOnce.indexOf(n),i>=0&&e[t].listenersOnce.splice(i,1))}(e,t,n)},publish(e,t,n){!function(e,t,n){if("string"==typeof t&&Object.prototype.hasOwnProperty.call(e,t)){for(let i=0;i<e[t].listeners.length;i++)e[t].listeners[i](n);for(let i=0;i<e[t].listenersOnce.length;i++)e[t].listenersOnce[i](n);e[t].listenersOnce.splice(0,e[t].listenersOnce.length)}}(e,t,n)}}}(),t}),function(){const e={extend(e,t){const n=Object.keys(t);for(let i=0;i<n.length;i++)e[n[i]]=t[n[i]];return e},assign(){const e=arguments[0];let t,n,i;for(i=1;i<arguments.length;i++)t=arguments[i],n=Object.keys(t).reduce((e,n)=>(e[n]=Object.getOwnPropertyDescriptor(t,n),e),{});return Object.defineProperties(e,n),e},isString:e=>"[object String]"===Object.prototype.toString.call(e),isNumber:e=>"[object Number]"===Object.prototype.toString.call(e),isObject(e){const t=typeof e;return("function"===t||"object"===t)&&!!e},isLiteralObject:e=>"[object Object]"===Object.prototype.toString.call(e),isFunction:e=>"[object Function]"===Object.prototype.toString.call(e),isArray:e=>"[object Array]"===Object.prototype.toString.call(e)};n.extend(n.src.lib._,e)}(),function(){const{_:e}=n.src.lib,i=n.src.component.generic,r=n.src.component.render;t.Component=function(t){let n;const r=function(){return this instanceof r?i.Construct.apply(this,n):(n=arguments,new r)},s=e.assign({},i.methods);return r.prototype=e.assign(s,t),r.prototype.constructor=r,r},t.Component._attachChild=function(e,t,n,i){r.attachChild(e,t,n,i)},t.Component._removeChild=function(e,t){r.removeChild(e,t)}}(),function(){const e=n.src.component.animate;n.extend(n.src.component.$,{$:function(t){const n=this.id;let i,r;return t?i=document.querySelector(`#${n}`).querySelector(t):(i=document.querySelector(`#${n}`),r=i),{0:i,id:i?i.id:null,_root:r,select:function(e){if("string"==typeof e&&this[0]){const t=this[0].querySelector(e);t&&(this[0]=t)}return this},selectChild:function(e){return"[object Number]"===Object.prototype.toString.call(e)&&(this[0]=this[0].children[e]?this[0].children[e]:this[0]),this},parent:function(){return this.root?this[0]!==this.root&&(this[0]=this[0].parentNode):this[0]=this[0].parentNode,this},firstParent:function(){return this._root&&(this[0]=this._root),this},html:function(e){return e?(this[0].innerHTML=e,this):this[0].innerHTML},empty:function(){for(;this[0].firstChild;)this[0].removeChild(this[0].firstChild);return this},append:function(e){const t=document.createElement(e);return this[0]=this[0].appendChild(t),this},appendTextChild:function(e){return this[0].appendChild(document.createTextNode(e)),this},appendBefore:function(e,t){const n=document.createElement(e),i=this[0].querySelector(t);return this[0].insertBefore(n,i),this[0]=n,this},appendAfter:function(e,t){const n=document.createElementNS(e),i=this[0].querySelector(t).nextElementSibling;return this[0].insertBefore(n,i),this[0]=n,this},replace:function(e){const t=document.createElement(e);return this[0].parentNode.replaceChild(t,this[0]),this[0]=t,this},appendHTML:function(e){return"string"==typeof e&&this[0].insertAdjacentHTML("beforeend",e),this},prepend:function(e){return"string"==typeof e&&this[0].insertAdjacentHTML("afterbegin",e),this},after:function(e){return"string"==typeof e&&this[0].id!==n&&this[0].insertAdjacentHTML("afterend",e),this},before:function(e){return"string"==typeof e&&this[0].id!==n&&this[0].insertAdjacentHTML("beforebegin",e),this},replaceWith:function(e){const t=this[0],i=t.parentNode,r=document.createElement("div");if("string"==typeof e&&t.id!==n){r.innerHTML=e;const n=r.firstChild;i.replaceChild(n,t)}return this},text:function(e){return void 0!==e?(this[0].textContent=e,this):this[0].textContent},clone:function(e){return!0===e||!1===e?this[0].cloneNode(e):this[0].cloneNode(!0)},firstChild:function(){return this[0].firstChild},insertChildBefore:function(e,t){return e&&this[0].insertBefore(e,t),this},removeChild:function(e){return e&&this[0].removeChild(e),this},replaceChild:function(e,t){return e&&this[0].replaceChild(e,t),this},children:function(){return this[0].children},childIndex:function(){let e=this[0],t=0;for(;null!==e;)e=e.previousElementSibling,t+=1;return t-1},getRect:function(){return this[0]?this[0].getBoundingClientRect():null},css:function(e,t){const n="string"==typeof e?e.split("-"):[];let i="";for(let e=0;e<n.length;e++)i+=0===e?n[e]:n[e].charAt(0).toUpperCase()+n[e].slice(1);return t?(this[0].style[i]=t,this):this[0].style[i]},getClassList:function(){return this[0].classList},addClass:function(e){return this[0].classList.add(e),this},addClasses:function(e){if(Array.isArray(e))for(let t=0;t<e.length;t++)this[0].classList.add(e[t]);return this},removeClass:function(e){return this[0].classList.remove(e),this},removeClasses:function(e){if(Array.isArray(e))for(let t=0;t<e.length;t++)this[0].classList.remove(e[t]);return this},toggleClass:function(e){return this[0].classList.toggle(e),this},hasClass:function(e){const t=this[0].classList.value.split(" ");return"[object String]"===Object.prototype.toString.call(e)&&-1!==t.indexOf(e)},attr:function(e,t){return t?(this[0].setAttribute(e,t),this):this[0].getAttribute(e)},removeAttr:function(e){return e&&this[0].removeAttribute(e),this},animate:function(...t){return e.animate(this[0],...t),this},on:function(e,t){return this[0].addEventListener(e,t),this},off:function(e,t){return this[0].removeEventListener(e,t),this},trigger:function(e){return this[0].dispatchEvent(new Event(e))}}}})}(),function(){const{_:e}=n.src.lib;function t(e,t,n,i){return n*(.5-Math.cos(e/i*Math.PI)/2)+t}function i(t){const n=e.isString(t)?t.split("-"):[];let i="";for(let e=0;e<n.length;e++)i+=0===e?n[e]:n[e].charAt(0).toUpperCase()+n[e].slice(1);return i}function r(e,t,n,r,s,o){const c=function(e,t){const n=Object.keys(t),r=window.getComputedStyle(e),s={},o=[];let c,l,a,u;for(let h=0;h<n.length;h++)c=i(n[h]),l=r.getPropertyValue(c),l&&(o.push(c),l=parseFloat(l,10),u=t[n[h]].replace(/[0-9.]/g,""),"%"===u&&(a=parseFloat(window.getComputedStyle(e.parentNode).getPropertyValue(c)),l=l/a*100),s[c]={initial:l,change:parseFloat(t[n[h]])-l,suffix:u});return s.name=o,s}(e,t),l=e;let a,u=0;const h=setInterval(()=>{for(let e=0;e<c.name.length;e++)a=n(u,c[c.name[e]].initial,c[c.name[e]].change,r),l.style[c.name[e]]=a+c[c.name[e]].suffix;u+=s,u>r&&(clearInterval(h),o&&o())},s)}const s={animate(n,i,...s){if(!e.isLiteralObject(i))return;const o=function(...t){const n=t[0],i=t[1],r=t[2];let s,o,c,l;switch(s=n||i||r?!n||i||i?n&&i&&!r?2:3:1:0,s){case 0:break;case 1:e.isNumber(n)||"fast"===n||"slow"===n?o=n:e.isString(n)?c=n:e.isFunction(n)&&(l=n);break;case 2:e.isNumber(n)||"fast"===n||"slow"===n?(o=n,e.isString(i)?c=i:e.isFunction(i)&&(l=i)):e.isString(n)&&(c=n,e.isFunction(i)&&(l=i));break;case 3:(e.isNumber(n)||"fast"===n||"slow"===n)&&(o=n),e.isString(i)&&(c=i),e.isFunction(r)&&(l=r)}return{duration:o,easing:c,callback:l}}(...s),c=e.isNumber(o.duration)&&o.duration>0?o.duration:"fast"===(l=o.duration)?200:"slow"===l?600:400;var l;r(n,i,window.Easing&&window.Easing[o.easing]?window.Easing[o.easing]:t,c,10,o.callback?o.callback:null)}};n.extend(n.src.component.animate,s)}(),function(){const{_:e}=n.src.lib,t=n.src.component.$,i=n.src.component.render,r=n.src.component.util;const s={_init(t){return this._tag=null,this._cList=null,this._mess=null,this.id=`i${Math.random().toString(36).substr(2,7)}`,this.children=null,this.props={},this.props.options=e.isLiteralObject(arguments[0])?arguments[0]:{},this.props.options=t,this.name="mynameisnobody",this.init(),this},_renderer(){return i.render(this)},$:t.$,$hyperscript(e,t){const n=[];for(let e=2;e<arguments.length;e++)n.push(arguments[e]);return{nodeName:e,attributes:t,children:n}},$getIdAndName(){return{id:this.id,name:this.name}},$getChildren(){return r.getChildren(this)},$getChild(e){return r.getChild(this,e)},$show(){return this.$().css("display","block"),this},$hide(){return this.$().css("display","none"),this},$listen(e,t){return this._mess.subscribe(e,t),this},$emit(e,t){return this._mess.publish(e,t),this},init(){return this},events(){return this},render:()=>"<div></div>"};n.extend(n.src.component.generic,{Construct:function(){this._init.apply(this,arguments)},methods:s})}(),function(){const{_:e}=n.src.lib;function t(e){const t=Object.keys(e);let n="";for(let i=0;i<t.length;i++)n+=i<t.length-1?`${t[i]}: ${e[t[i]]}; `:`${t[i]}: ${e[t[i]]};`;return n}const i={render(n,i){const r={};return function(e,t,n){const i=Object.keys(n);for(let r=0;r<i.length;r++)e=e.replace(`</${i[r].toLowerCase()}>`,"").replace(i[r].toLowerCase(),`${i[r]} /`),t[`<${i[r]} />`]=n[i[r]];return e}((new XMLSerializer).serializeToString(function n(i,r){const{nodeName:s}=i,{attributes:o}=i,{children:c}=i;let l,a,u,h,d,p;if(e.isString(i))return document.createTextNode(i);switch(typeof s){case"string":for(l=document.createElement(s),a=o?Object.keys(o):[],p=0;p<a.length;p++)u=e.isObject(o[a[p]])?t(o[a[p]]):o[a[p]],l.setAttribute(a[p],u);break;case"function":h=s(),h.render?(d=o&&o.name?o.name:`C${Math.random().toString(36).substr(2,7)}`,r[d]={fn:s,options:o.options?o.options:null},l=n({nodeName:d,attributes:null,children:[]},r)):l=n(h,r);break;default:throw new Error(`hypserscript._render: nodeName is a ${typeof s} ???`)}for(p=0;p<c.length;p++)l.appendChild(n(c[p],r));return l}(n,r)).replace('xmlns="http://www.w3.org/1999/xhtml"',""),i,r)}};n.extend(n.src.component.hyperscript,i)}(),function(){const{_:e}=n.src.lib,t=n.src.component.hyperscript;function i(n){let i,r;if(i=n.render(),e.isLiteralObject(i)&&e.isString(i.nodeName)&&(n.children={},i=t.render(i,n.children)),r=i.match(/^\s*<div/)?i.replace(/^\s*<div/,`<div id="${n.id}"`):i.match(/^\s*<header/)?i.replace(/^\s*<header/,`<header id="${n.id}"`):i.match(/^\s*<footer/)?i.replace(/^\s*<footer/,`<footer id="${n.id}"`):i,n.children){n.children=function(t){if(!e.isLiteralObject(t))return{};const n={},i=Object.keys(t);let r;for(let s=0;s<i.length;s++)r=i[s],e.isFunction(t[r])?n[r]={fn:t[r],options:null}:e.isLiteralObject(t[r])&&e.isFunction(t[r].fn)?n[r]={fn:t[r].fn,options:t[r].options}:(n[r]={fn:null,options:null},console.log('warning: this component list is invalid. key "c" is missing!'));return n}(n.children),n._cList={};const t=Object.keys(n.children);let i,s;for(let o=0;o<t.length;o++)i=t[o],e.isFunction(n.children[i].fn)?(s=n.children[i].fn(n.children[i].options),s._tag=i,r=r.replace(i,s._renderer()),n._cList[i.replace(/[^a-zA-z0-9]/g,"")]=s):console.log(`warning: there is no component associated to this tag: ${i}!`)}return r}const r={render:e=>i(e),attachChild(e,t,n,i){!function(e,t,n,i){const r=t(n);r._tag=i,e._cList||(e._cList={}),e.children||(e.children={}),e._cList[r._tag.replace(/[^a-zA-z0-9]/g,"")]=r,e.children[i]={fn:t,options:n}}(e,t,n,i)},removeChild(t,n){!function(t,n){e.isString(n)&&e.isLiteralObject(t._cList)&&(delete t._cList[n.replace(/[^a-zA-z0-9]/g,"")],delete t.children[n])}(t,n)}};n.extend(n.src.component.render,r)}(),function(){const{_:e}=n.src.lib;const t={getChildren:e=>e._cList?function(e){const t=Object.keys(e._cList),n=[];for(let i=0;i<t.length;i++)n.push({id:e._cList[t[i]].id,name:e._cList[t[i]].name});return n}(e):null,getChild:(t,n)=>n&&e.isString(n)?function e(t,n){if(!t._cList)return null;const i=Object.keys(t._cList);let r;for(let s=0;s<i.length;s++){if(r=i[s],n===t._cList[r]._tag||n===t._cList[r].id||n===t._cList[r].name)return t._cList[r];const o=e(t._cList[r],n);if(o)return o}return null}(t,n):null};n.extend(n.src.component.util,t)}(),function(){const{Messenger:e}=n.src.libin,{_:i}=n.src.lib;function r(e){if(e._cList){const t=Object.keys(e._cList);for(let n=0;n<t.length;n++)e._cList[t[n]].events(),r(e._cList[t[n]])}}function s(e,t){if(e._cList){const n=Object.keys(e._cList);for(let i=0;i<n.length;i++)e._cList[n[i]]._mess=t,s(e._cList[n[i]],t)}}function o(e){const t={el:"body",children:null,template:"<div></div>"};return e.el&&(!i.isString(e.el)||"#"!==e.el.charAt(0)&&"."!==e.el.charAt(0)?i.isObject(e.el)&&e.el.namespaceURI?t.el=e.el:console.log("warning: el must be an id, a class or a node element!"):t.el=e.el),i.isString(e.template)&&(e.template.includes("<div")||e.template.includes("<header")||e.template.includes("<footer"))?t.template=e.template:console.log("warning: template must be an XMLString starting with <div or <header or <footer!"),t.children=e.children,t}function c(e){const t=i.isString(e.el)?document.querySelector(e.el):e.el;"body"===e.el?t.innerHTML+=e.template:t.innerHTML=e.template}function l(n){const l=o(n);if(!n.children&&!n.template)return function(n){const r=o(n);if("body"===r.el)return null;let s;s=i.isString(r.el)?document.querySelector(r.el):r.el;const c=s.outerHTML,l=s.getAttribute("id");l&&s.removeAttribute("id");const a=s.outerHTML;let u={};n.methods&&(u=n.methods);const h=t.Component(i.extend(u,{render:()=>a}))(),d=h._renderer(),p=document.createElement("template");p.innerHTML=d;const f=p.content.firstChild;return s.parentNode.replaceChild(f,s),l&&(f.setAttribute("id",l),h.id=l),h._mess=e(),h._initialXMLNode=c,h}(n);if(!l.children)return c(l),null;const a=t.Component({render(){return this.name="firstparent",this.children=l.children,l.template}})();return l.template=a._renderer(),c(l),a._mess=e(),s(a,a._mess),r(a),a}function a(e,t,n,r){const s=e.$getChild(t)._renderer();n?i.isString(n)&&e.$(n)[0]?"first"===r?e.$(n).prepend(s):e.$(n).appendHTML(s):(console.log("warning: View.append: params.el is not valid! Component appended to the parent node."),"first"===r?e.$().prepend(s):e.$().appendHTML(s)):"first"===r?e.$().prepend(s):e.$().appendHTML(s)}function u(e,n){const{root:o}=e,{children:c}=e,{el:l}=e;let u,h,d,p,f,m,{parent:g}=e;if(g||(g=o),i.isString(g)){if(!i.isObject(o)||!Object.prototype.hasOwnProperty.call(o,"_cList"))return console.log("warning: View.append: params.root is not valid!"),null;if(u=o.$getChild(g),!u)return console.log(`warning: View.append: ${g} does not exist!`),null}else{if(!i.isObject(g)||!Object.prototype.hasOwnProperty.call(g,"_cList"))return console.log(`warning: View.append: ${g} is improperly defined!`),null;u=g}if(!i.isLiteralObject(c))return console.log("warning: View.append: params.children is not valid!"),null;const b=Object.keys(c);for(let e=0;e<b.length;e++){if(m=b[e],h=c[b[e]],i.isLiteralObject(h))p=h.fn,f=h.options;else{if(!i.isFunction(h))return console.log("warning: View.append: params.children is not valid!"),null;p=h,f=void 0}t.Component._attachChild(u,p,f,m),a(u,m,l,n),d=u.$getChild(m),d._mess=u._mess,s(d,u._mess),d.events(),r(d)}return!0}const h={render:e=>l(e),restore:e=>(function(e){if(e._initialXMLNode){const t=document.createElement("template");t.innerHTML=e._initialXMLNode;const n=t.content.firstChild;return e.$()[0].parentNode.replaceChild(n,e.$()[0]),!0}return!1})(e),append:e=>u(e),prepend:e=>u(e,"first"),remove:e=>(function(e){const{root:n}=e,{parent:r}=e,{children:s}=e;let o;if(i.isString(r)){if(!i.isObject(n)||!Object.prototype.hasOwnProperty.call(n,"_cList"))return console.log("warning: View.append: params.root is not valid!"),null;if(o=n.$getChild(r),!o)return console.log(`warning: View.append: ${r} does not exist!`),null}else{if(!i.isObject(r)||!Object.prototype.hasOwnProperty.call(r,"_cList"))return console.log(`warning: View.append: ${r} is improperly defined!`),null;o=r}if(!i.isString(s))return console.log("warning: View.append: params.children is not valid!"),null;const c=o.$getChild(s),l=o.$(`#${c.id}`)[0];return o.$(`#${c.id}`).parent().removeChild(l),t.Component._removeChild(o,s),!0})(e)};n.extend(n.src.renderer.main,h)}(),t});