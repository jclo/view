/*! ****************************************************************************
 * View v0.0.0
 *
 * A companion View library for building web applications.
 * (you can download it from npm or github repositories)
 * Copyright (c) 2019 Mobilabs <contact@mobilabs.fr> (http://www.mobilabs.fr).
 * Released under the MIT license. You may obtain a copy of the License
 * at: http://www.opensource.org/licenses/mit-license.php).
 * ************************************************************************** */
!function(t,e){"use strict";"function"==typeof define&&define.amd?define([""],e):"object"==typeof exports?(module.exports=e(t),null===t.view&&(t.view=e(t))):t.View=e(t)}(this,t=>{"use strict";let e,n;const i={_:n,Messenger:null,Component:{Public:{},Generic:{},Dollar:{},Animation:{},Hyperscript:{},Render:{},Util:{}},Renderer:{Public:{}}};return n={extend(t,e){const n=Object.keys(e);for(let i=0;i<n.length;i++)t[n[i]]=e[n[i]]},assign(){const t=arguments[0];let e,n,i;for(i=1;i<arguments.length;i++)e=arguments[i],n=Object.keys(e).reduce((t,n)=>(t[n]=Object.getOwnPropertyDescriptor(e,n),t),{});return Object.defineProperties(t,n),t},isString:t=>"[object String]"===Object.prototype.toString.call(t),isNumber:t=>"[object Number]"===Object.prototype.toString.call(t),isObject(t){const e=typeof t;return("function"===e||"object"===e)&&!!t},isLiteralObject:t=>"[object Object]"===Object.prototype.toString.call(t),isFunction:t=>"[object Function]"===Object.prototype.toString.call(t),isArray:t=>"[object Array]"===Object.prototype.toString.call(t)},function(){let t;function e(t,e){"string"==typeof e&&function(t,e){Object.prototype.hasOwnProperty.call(t,e)||(t[e]={listeners:[],listenersOnce:[]})}(t,e)}i.Messenger=function(){const e=Object.create(t);return e._db={},e},t={subscribe(t,n){return function(t,n,i){e(t,n),"string"==typeof n&&"function"==typeof i&&Object.prototype.hasOwnProperty.call(t,n)&&t[n].listeners.push(i)}(this._db,t,n),this},subscribeOnce(t,n){return function(t,n,i){e(t,n),"string"==typeof n&&"function"==typeof i&&Object.prototype.hasOwnProperty.call(t,n)&&t[n].listenersOnce.push(i)}(this._db,t,n),this},unsubscribe(t,e){return function(t,e,n){let i;"string"==typeof e&&"function"==typeof n&&Object.prototype.hasOwnProperty.call(t,e)&&((i=t[e].listeners.indexOf(n))>=0&&t[e].listeners.splice(i,1),(i=t[e].listenersOnce.indexOf(n))>=0&&t[e].listenersOnce.splice(i,1))}(this._db,t,e),this},publish(t,e){return function(t,e,n){if("string"==typeof e&&Object.prototype.hasOwnProperty.call(t,e)){for(let i=0;i<t[e].listeners.length;i++)t[e].listeners[i](n);for(let i=0;i<t[e].listenersOnce.length;i++)t[e].listenersOnce[i](n);t[e].listenersOnce.splice(0,t[e].listenersOnce.length)}}(this._db,t,e),this}}}(),function(){const r=i.Renderer.Public,s=t.View;(e={_setTestMode:()=>(i._=n,i),noConflict(){return t.View=s,this},render:t=>r.render(t)}).VERSION="0.0.0"}(),function(){const{Generic:t}=i.Component;e.Component=function(e){let i;const r=function(){return this instanceof r?t.Construct.apply(this,i):(i=arguments,new r)},s=n.assign({},t.methods);return r.prototype=n.assign(s,e),r.prototype.constructor=r,r}}(),function(){const t=i.Component.Dollar,e=i.Component.Animation;n.extend(t,{$:function(t){const n=this.id;let i;return{0:i=t?document.querySelector(`#${n}`).querySelector(t):document.querySelector(`#${n}`),id:i?i.id:null,select:function(t){if("string"==typeof t&&this[0]){const e=this[0].querySelector(t);e&&(this[0]=e)}return this},selectChild:function(t){return"[object Number]"===Object.prototype.toString.call(t)&&(this[0]=this[0].children[t]?this[0].children[t]:this[0]),this},parent:function(){return this.root?this[0]!==this.root&&(this[0]=this[0].parentNode):this[0]=this[0].parentNode,this},firstParent:function(){return this.root&&(this[0]=this.root),this},html:function(t){return t?(this[0].innerHTML=t,this):this[0].innerHTML},empty:function(){for(;this[0].firstChild;)this[0].removeChild(this[0].firstChild);return this},append:function(t){const e=document.createElement(t);return this[0]=this[0].appendChild(e),this},appendTextChild:function(t){return this[0].appendChild(document.createTextNode(t)),this},appendBefore:function(t,e){const n=document.createElement(t),i=this[0].querySelector(e);return this[0].insertBefore(n,i),this[0]=n,this},appendAfter:function(t,e){const n=document.createElementNS(t),i=this[0].querySelector(e).nextElementSibling;return this[0].insertBefore(n,i),this[0]=n,this},replace:function(t){const e=document.createElement(t);return this[0].parentNode.replaceChild(e,this[0]),this[0]=e,this},appendHTML:function(t){return"string"==typeof t&&this[0].insertAdjacentHTML("beforeend",t),this},prepend:function(t){return"string"==typeof t&&this[0].insertAdjacentHTML("afterbegin",t),this},after:function(t){return"string"==typeof t&&this[0].id!==n&&this[0].insertAdjacentHTML("afterend",t),this},before:function(t){return"string"==typeof t&&this[0].id!==n&&this[0].insertAdjacentHTML("beforebegin",t),this},replaceWith:function(t){const e=this[0],i=e.parentNode,r=document.createElement("div");if("string"==typeof t&&e.id!==n){r.innerHTML=t;const n=r.firstChild;i.replaceChild(n,e)}return this},text:function(t){return void 0!==t?(this[0].textContent=t,this):this[0].textContent},clone:function(t){return!0===t||!1===t?this[0].cloneNode(t):this[0].cloneNode(!0)},insertChildBefore:function(t,e){return t&&this[0].insertBefore(t,e),this},removeChild:function(t){return t&&this[0].removeChild(t),this},replaceChild:function(t,e){return t&&this[0].replaceChild(t,e),this},children:function(){return this[0].children},childIndex:function(){let t=this[0],e=0;for(;null!==t;)t=t.previousElementSibling,e+=1;return e-1},getRect:function(){return this[0]?this[0].getBoundingClientRect():null},css:function(t,e){const n="string"==typeof t?t.split("-"):[];let i="";for(let t=0;t<n.length;t++)i+=0===t?n[t]:n[t].charAt(0).toUpperCase()+n[t].slice(1);return e?(this[0].style[i]=e,this):this[0].style[i]},getClassList:function(){return this[0].classList},addClass:function(t){return this[0].classList.add(t),this},addClasses:function(t){if(Array.isArray(t))for(let e=0;e<t.length;e++)this[0].classList.add(t[e]);return this},removeClass:function(t){return this[0].classList.remove(t),this},removeClasses:function(t){if(Array.isArray(t))for(let e=0;e<t.length;e++)this[0].classList.remove(t[e]);return this},toggleClass:function(t){return this[0].classList.toggle(t),this},hasClass:function(t){const e=this[0].classList.value.split(" ");return"[object String]"===Object.prototype.toString.call(t)&&-1!==e.indexOf(t)},attr:function(t,e){return e?(this[0].setAttribute(t,e),this):this[0].getAttribute(t)},removeAttr:function(t){return t&&this[0].removeAttribute(t),this},animate:function(...t){return e.animate(this[0],...t),this},on:function(t,e){return this[0].addEventListener(t,e),this},off:function(t,e){return this[0].removeEventListener(t,e),this}}}})}(),function(){const t=i.Component.Generic,{$:e}=i.Component.Dollar,r=i.Component.Render,{Util:s}=i.Component;const o={_init(t){return this._tag=null,this._cList=null,this._mess=null,this.id=`i${Math.random().toString(36).substr(2,7)}`,this.children=null,this.props={},this.props.options=n.isLiteralObject(arguments[0])?arguments[0]:{},this.props.options=t,this.name="mynameisnobody",this.init(),this},_renderer(){return r.render(this)},$:e,$hyperscript(t,e){const n=[];for(let t=2;t<arguments.length;t++)n.push(arguments[t]);return{nodeName:t,attributes:e,children:n}},$getIdAndName(){return{id:this.id,name:this.name}},$getChildren(){return s.getChildren(this)},$getChild(t){return s.getChild(this,t)},$show(){return this.$().css("display","block"),this},$hide(){return this.$().css("display","none"),this},$listen(t,e){return this._mess.subscribe(t,e),this},$emit(t,e){return this._mess.publish(t,e),this},init(){return this},events(){return this},render:()=>"<div></div>"};n.extend(t,{Construct:function(){this._init.apply(this,arguments)},methods:o})}(),function(){const t=i.Component.Animation;function e(t,e,n,i){return n*(.5-Math.cos(t/i*Math.PI)/2)+e}function r(t){const e=n.isString(t)?t.split("-"):[];let i="";for(let t=0;t<e.length;t++)i+=0===t?e[t]:e[t].charAt(0).toUpperCase()+e[t].slice(1);return i}function s(t,e,n,i,s,o){const c=function(t,e){const n=Object.keys(e),i=window.getComputedStyle(t),s={},o=[];let c,l,u,h;for(let a=0;a<n.length;a++)c=r(n[a]),(l=i.getPropertyValue(c))&&(o.push(c),l=parseFloat(l,10),"%"===(h=e[n[a]].replace(/[0-9.]/g,""))&&(l=l/(u=parseFloat(window.getComputedStyle(t.parentNode).getPropertyValue(c)))*100),s[c]={initial:l,change:parseFloat(e[n[a]])-l,suffix:h});return s.name=o,s}(t,e),l=t;let u,h=0;const a=setInterval(()=>{for(let t=0;t<c.name.length;t++)u=n(h,c[c.name[t]].initial,c[c.name[t]].change,i),l.style[c.name[t]]=u+c[c.name[t]].suffix;(h+=s)>i&&(clearInterval(a),o&&o())},s)}n.extend(t,{animate(t,i,...r){if(!n.isLiteralObject(i))return;const o=function(...t){const e=t[0],i=t[1],r=t[2];let s,o,c,l;switch(s=e||i||r?!e||i||i?e&&i&&!r?2:3:1:0){case 0:break;case 1:n.isNumber(e)||"fast"===e||"slow"===e?o=e:n.isString(e)?c=e:n.isFunction(e)&&(l=e);break;case 2:n.isNumber(e)||"fast"===e||"slow"===e?(o=e,n.isString(i)?c=i:n.isFunction(i)&&(l=i)):n.isString(e)&&(c=e,n.isFunction(i)&&(l=i));break;case 3:(n.isNumber(e)||"fast"===e||"slow"===e)&&(o=e),n.isString(i)&&(c=i),n.isFunction(r)&&(l=r)}return{duration:o,easing:c,callback:l}}(...r),c=n.isNumber(o.duration)?r.duration:"fast"===(l=o.duration)?200:"slow"===l?600:400;var l;s(t,i,window.Easing&&window.Easing[o.easing]?window.Easing[o.easing]:e,c,10,o.callback?o.callback:null)}})}(),function(){const t=i.Component.Hyperscript;function e(t){const e=Object.keys(t);let n="";for(let i=0;i<e.length;i++)n+=i<e.length-1?`${e[i]}: ${t[e[i]]}; `:`${e[i]}: ${t[e[i]]};`;return n}n.extend(t,{render(t,i){const r={};return function(t,e,n){const i=Object.keys(n);for(let r=0;r<i.length;r++)t=t.replace(`</${i[r].toLowerCase()}>`,"").replace(i[r].toLowerCase(),`${i[r]} /`),e[`<${i[r]} />`]=n[i[r]];return t}((new XMLSerializer).serializeToString(function t(i,r){const{nodeName:s}=i,{attributes:o}=i,{children:c}=i;let l,u,h,a,d,f;if(n.isString(i))return document.createTextNode(i);switch(typeof s){case"string":for(l=document.createElement(s),u=o?Object.keys(o):[],f=0;f<u.length;f++)h=n.isObject(o[u[f]])?e(o[u[f]]):o[u[f]],l.setAttribute(u[f],h);break;case"function":(a=s()).render?(r[d=o&&o.name?o.name:`C${Math.random().toString(36).substr(2,7)}`]={fn:s,options:o.options?o.options:null},l=t({nodeName:d,attributes:null,children:[]},r)):l=t(a,r);break;default:throw new Error(`hypserscript._render: nodeName is a ${typeof s} ???`)}for(f=0;f<c.length;f++)l.appendChild(t(c[f],r));return l}(t,r)).replace('xmlns="http://www.w3.org/1999/xhtml"',""),i,r)}})}(),function(){const t=i.Component.Render,e=i.Component.Hyperscript;function r(t){let i,r;if(i=t.render(),n.isLiteralObject(i)&&n.isString(i.nodeName)&&(t.children={},i=e.render(i,t.children)),r=i.match(/^\s*<div/)?i.replace(/^\s*<div/,`<div id="${t.id}"`):i.match(/^\s*<header/)?i.replace(/^\s*<header/,`<header id="${t.id}"`):i.match(/^\s*<footer/)?i.replace(/^\s*<footer/,`<footer id="${t.id}"`):i,t.children){t.children=function(t){if(!n.isLiteralObject(t))return{};const e={},i=Object.keys(t);let r;for(let s=0;s<i.length;s++)r=i[s],n.isFunction(t[r])?e[r]={fn:t[r],options:null}:n.isLiteralObject(t[r])&&n.isFunction(t[r].fn)?e[r]={fn:t[r].fn,options:t[r].options}:(e[r]={fn:null,options:null},console.log('warning: this component list is invalid. key "c" is missing!'));return e}(t.children),t._cList={};const e=Object.keys(t.children);let i,s;for(let o=0;o<e.length;o++)i=e[o],n.isFunction(t.children[i].fn)?((s=t.children[i].fn(t.children[i].options))._tag=i,r=r.replace(i,s._renderer()),t._cList[i.replace(/[^a-zA-z0-9]/g,"")]=s):console.log(`warning: there is no component associated to this tag: ${i}!`)}return r}n.extend(t,{render:t=>r(t)})}(),function(){const t=i.Component.Util;n.extend(t,{getChildren:t=>t._cList?function(t){const e=Object.keys(t._cList),n=[];for(let i=0;i<e.length;i++)n.push({id:t._cList[e[i]].id,name:t._cList[e[i]].name});return n}(t):null,getChild:(t,e)=>e&&n.isString(e)?function t(e,n){if(!e._cList)return null;const i=Object.keys(e._cList);let r;for(let s=0;s<i.length;s++){if(r=i[s],n===e._cList[r]._tag||n===e._cList[r].id||n===e._cList[r].name)return e._cList[r];const o=t(e._cList[r],n);if(o)return o}return null}(t,e):null})}(),function(){const t=i.Renderer.Public,{Messenger:r}=i;function s(t){const e=n.isString(t.el)?document.querySelector(t.el):t.el;"body"===t.el?e.innerHTML+=t.template:e.innerHTML=t.template}function o(t){const i=function(t){const e={el:"body",children:null,template:"<div></div>"};return t.el&&(!n.isString(t.el)||"#"!==t.el.charAt(0)&&"."!==t.el.charAt(0)?n.isObject(t.el)&&t.el.namespaceURI?e.el=t.el:console.log("warning: el must be an id, a class or a node element!"):e.el=t.el),n.isString(t.template)&&(t.template.includes("<div")||t.template.includes("<header")||t.template.includes("<footer"))?e.template=t.template:console.log("warning: template must be an XMLString starting with <div or <header or <footer!"),e.children=t.children,e}(t);if(!i.children)return s(i),null;const o=e.Component({render(){return this.name="firstparent",this.children=i.children,i.template}})();return i.template=o._renderer(),s(i),o._mess=r(),function t(e,n){if(e._cList){const i=Object.keys(e._cList);for(let r=0;r<i.length;r++)e._cList[i[r]]._mess=n,t(e._cList[i[r]],n)}}(o,o._mess),function t(e){if(e._cList){const n=Object.keys(e._cList);for(let i=0;i<n.length;i++)e._cList[n[i]].events(),t(e._cList[n[i]])}}(o),o}n.extend(t,{render:t=>o(t)})}(),e});